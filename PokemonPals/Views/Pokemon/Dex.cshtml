@model PokemonPals.Models.ViewModels.PokemonAndCaughtPokemonViewModel

@{
    ViewData["Title"] = "Index";
}

<div class="global-header">
    <h1>Pokedex</h1>
    @{
        decimal totalCount = 0;
        if (Model.PokemonCaught != null)
        {
            totalCount = Model.PokemonCaught.Count();
        }
        decimal totalPercent = (totalCount / Model.AllPokemon.Count()) * 100;
        string percentString = totalPercent.ToString("0.##");

        <div class="dex-progress-bar">
            <div class="dex-progress-completion" style="width:@percentString%"></div>
            <p class="dex-progress-text">@totalCount of @Model.AllPokemon.Count() caught // @percentString%</p>
        </div>
    }
</div>

<div class="dex-container">
    @foreach (Pokemon singlePokemon in Model.AllPokemon)
    {
        string caughtClass = "";
        if (Model.PokemonCaught != null)
        {
            if (Model.PokemonCaught.Contains(singlePokemon.Id))
            {
                caughtClass = "dex-caught";
            }
        }
        <container class="dex-card @caughtClass">
            <a asp-action="Details" asp-route-id="@singlePokemon.Id"><img class="sprite-img" src=@singlePokemon.RBSpriteURL /></a>
            @{
                string threeDigitId = "";
                if (singlePokemon.PokedexNumber < 10)
                {
                    threeDigitId = $"00{singlePokemon.PokedexNumber}";
                }
                else if (singlePokemon.PokedexNumber < 100)
                {
                    threeDigitId = $"0{singlePokemon.PokedexNumber}";
                }
                else
                {
                    threeDigitId = $"{singlePokemon.PokedexNumber}";
                }
            }
            <div>
                <a asp-action="Details" asp-route-id="@singlePokemon.Id">@threeDigitId <br /> @singlePokemon.Name</a> <br />
                <a asp-controller="CaughtPokemon" asp-action="Create" asp-route-id="@singlePokemon.Id"><img class="pokeball-img" src="@Url.Content("~/images/pokeball.png")" /></a>
            </div>
        </container>
    }
</div>
